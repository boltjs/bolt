How to make a major upgrade .msi
================================

1. Bump the version number of bolt - you must increment one of the first three
   version number segments, as Windows Installer only uses the first three
   parts of version numbers for version checking.

2. Remove or add components as necessary to the .wxs file. Make sure you give
   new components a fresh UUID (you can use the uuid command line utility on Mac
   OS X, or similar tools on other systems, to generate one).

3. That's it. Test upgrading from an old version with the new installer works,
   the new version uninstalls cleanly, bolt works as expected, etc.

Good to knows
=============

* For whatever reason building the installer will fail if you run the installer
  build from any drive except C:. The exception thrown is:

    light.exe : error LGHT0001 : The system cannot find the path specified. (Exception from HRESULT: 0x80070003)

    Exception Type: System.IO.DirectoryNotFoundException

    Stack Trace:
       at Microsoft.Tools.WindowsInstallerXml.Cab.Interop.NativeMethods.CreateCabFinish(IntPtr contextHandle)
       at Microsoft.Tools.WindowsInstallerXml.Cab.WixCreateCab.Complete()
       at Microsoft.Tools.WindowsInstallerXml.CabinetBuilder.CreateCabinet(CabinetWorkItem cabinetWorkItem)
       at Microsoft.Tools.WindowsInstallerXml.CabinetBuilder.ProcessWorkItems()

  if you see this, the workaround is to re-run the installer build from C: drive.
